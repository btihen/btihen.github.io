<!DOCTYPE html><html lang="en-us" >

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Bill Tihen">

  
  
  
    
  
  <meta name="description" content="A simple Rails App that works off one page (a prep-project to build a Rails SPA with Hotwire)">

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/">

  


  
  
  
  <meta name="theme-color" content="#00008b">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/xcode.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/xcode.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu9e8c7d04b47910fd67a38e5a526b68e7_64368_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu9e8c7d04b47910fd67a38e5a526b68e7_64368_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@btihen">
  <meta property="twitter:creator" content="@btihen">
  
  <meta property="og:site_name" content="btihen">
  <meta property="og:url" content="http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/">
  <meta property="og:title" content="Tweets - A Single Page Rails App (using reloads) | btihen">
  <meta property="og:description" content="A simple Rails App that works off one page (a prep-project to build a Rails SPA with Hotwire)"><meta property="og:image" content="http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/featured.png">
  <meta property="twitter:image" content="http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-02-20T18:57:00&#43;02:00">
    
    <meta property="article:modified_time" content="2021-08-07T01:57:00&#43;02:00">
  

  



  


  


  





  <title>Tweets - A Single Page Rails App (using reloads) | btihen</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  






  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu0d53a2a03d4a529abcdd0318d0f2ad50_8175_0x70_resize_lanczos_3.png" alt="btihen"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu0d53a2a03d4a529abcdd0318d0f2ad50_8175_0x70_resize_lanczos_3.png" alt="btihen"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/authors/btihen/"><span>.me</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://container4.ch/" target="_blank" rel="noopener"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#post_ruby_rails"><span>Ruby</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#post_elixir_phoenix"><span>Elixir</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#post_crystal"><span>Crystal</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#post_tech_notes"><span>Tech</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#post_edu"><span>Edu</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Pubs</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#in_news"><span>News</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Tweets - A Single Page Rails App (using reloads)</h1>

  
  <p class="page-subtitle">A simple Rails App that uses one page</p>
  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span><a href="/authors/btihen/">Bill Tihen</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Sat, Aug 7, 2021
  </span>
  

  

  

  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 631px;">
  <div style="position: relative">
    <img src="/post_ruby_rails/rails_6_1_single_page_app_simulate/featured_hu1cd0b02e52f4cf0ad66a070bf4c1f181_74432_720x0_resize_lanczos_3.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="overview">Overview</h2>
<p>This article is just to have a base app that stays on the index page.  We will use this as a starting point for a more efficient single page app by updating this project with Hotwire in the next article 
<a href="/post_ruby_rails/rails_6_hotwire_tweet_single_page/">Tweets - A Rails based Single Page App using Hotwire</a></p>
<p>
<a href="https://hotwire.dev/" target="_blank" rel="noopener">Hotwire</a> allows us to build Single Page Apps using Ruby and Rails with nearly NO configuration! It allow very responsive web-applications as it reloads only the parts of the page that change via a socket.  Hotwire using 
<a href="https://turbo.hotwire.dev/" target="_blank" rel="noopener">Turbo</a> - an evolution of TurboLinks and as such is mobile friendly and in most cases can send the replacement HTML directly from the server to the client with minimal or no client side processing over websockets so there is minimal lag time.</p>
<p>This code can be found at: 
<a href="https://github.com/btihen/tweet_simulator_rails" target="_blank" rel="noopener">https://github.com/btihen/tweet_simulator_rails</a></p>
<h2 id="basic-setup">Basic Setup</h2>
<h3 id="create-the-project">Create the project</h3>
<p>We&rsquo;ll skip Turbolinks since Turbo replaces Turbolinks and also installs Stimulus</p>
<pre><code class="language-bash">rails new tweets -d postgresql -T --skip-turbolinks --skip-spring
cd tweets
git add .
git commit -m &quot;initial commit after creation&quot;
</code></pre>
<p>I generally take a lot of git snapshots (and then squash them - so its easy to go back to a known good point if things don&rsquo;t work out).</p>
<h3 id="create-a-traditional-rails-tweet-clone">Create a Traditional Rails Tweet Clone</h3>
<h4 id="tweet-model">Tweet Model</h4>
<p>We&rsquo;ll scaffold the model to get all the parts we need</p>
<pre><code class="language-bash">bin/rails g scaffold tweet body:text likes:integer retweets:integer
</code></pre>
<p>We&rsquo;ll update the migration to prevent blanks - make the migration file look like:</p>
<pre><code class="language-ruby"># db/migrate/yyyymmddHHMMSS_create_tweets.rb
class CreateTweets &lt; ActiveRecord::Migration[6.1]
  def change
    create_table :tweets do |t|
      t.text :body, null: false
      t.integer :likes, null: false, default: 0
      t.integer :retweets, null: false, default: 0

      t.timestamps
    end
  end
end
</code></pre>
<p>Now we should be able to successfully create and migrate out database</p>
<pre><code class="language-bash">bin/rails db:create
bin/rails db:migrate
</code></pre>
<p>Given the Database restrictions we&rsquo;ll add validations to the model. So now it should look like:</p>
<pre><code class="language-ruby"># app/models/tweet.rb
class Tweet &lt; ApplicationRecord
  validates :body, presence: true
end
</code></pre>
<p>Lets also point the root route at our tweets resource - so now it should look like:</p>
<pre><code class="language-ruby"># config/routes.rb
Rails.application.routes.draw do
  resources :tweets
  root to: &quot;tweets#index&quot;
end
</code></pre>
<p>Lets start up rails and be sure everything works so far:</p>
<pre><code class="language-bash">bin/rails s
</code></pre>
<p>go to <code>http://localhost:3000</code> and make and edit and delete some tweets.</p>
<p>Assuming it works lets commit these changes.</p>
<pre><code class="language-bash">git add .
git commit -m &quot;created tweet scaffold, validations and routes&quot;
</code></pre>
<h4 id="lets-make-this-useable-more-like-a-single-page-app">Let&rsquo;s make this useable (more like a single page app)</h4>
<p>Lets start by fixing the following problems:</p>
<ol>
<li>the create form allows us to choose and edit likes and retweets</li>
<li>tweets are listed in the opposite order in oldest to newest</li>
<li>to create a new tweet we need to go to a separate new page</li>
<li>creating and editing new tweets brings us to a show page (away from our index)</li>
<li>message, likes, retweets, etc are all listed in one long table row (we&rsquo;ll fix with some bootstrap css)</li>
<li>likes and retweets are not usable</li>
</ol>
<p>As mentioned users shouldn&rsquo;t choose their likes and retweets:
<img src="tweet_form_1st.png" alt="tweet_form_1st"></p>
<p>Now lets remove likes and retweets from our form:</p>
<pre><code class="language-ruby"># app/views/tweets/_form.html.erb
&lt;%= form_with(model: tweet) do |form| %&gt;
  &lt;% if tweet.errors.any? %&gt;
    &lt;div id=&quot;error_explanation&quot;&gt;
      &lt;h2&gt;&lt;%= pluralize(tweet.errors.count, &quot;error&quot;) %&gt; prohibited this tweet from being saved:&lt;/h2&gt;

      &lt;ul&gt;
        &lt;% tweet.errors.each do |error| %&gt;
          &lt;li&gt;&lt;%= error.full_message %&gt;&lt;/li&gt;
        &lt;% end %&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;% end %&gt;

  &lt;div class=&quot;field&quot;&gt;
    &lt;%= form.label :body %&gt;
    &lt;%= form.text_area :body %&gt;
  &lt;/div&gt;

  &lt;div class=&quot;actions&quot;&gt;
    &lt;%= form.submit %&gt;
  &lt;/div&gt;
&lt;% end %&gt;
</code></pre>
<p>Now the form should look like:
<img src="tweet_form_2nd.png" alt="tweet_form_2nd"></p>
<p>If you made several tweets you&rsquo;ll notice that the tweets are in oldest to newest.
<img src="tweet_index_1st_oldest.png" alt="tweet_index_1st"></p>
<p>We&rsquo;ll fix that with the index controller sort order:</p>
<pre><code class="language-ruby"># app/controllers/tweets_controller.rb
class TweetsController &lt; ApplicationController
  before_action :set_tweet, only: %i[ show edit update destroy ]

  def index
    @tweets = Tweet.all.order(created_at: :desc)
  end
  ...
end
</code></pre>
<p><img src="tweet_index_2nd_newest.png" alt="tweet_index_2nd"></p>
<p>now tweets should be newest to oldest</p>
<p>Let&rsquo;s put our create tweet at the top of our index page</p>
<pre><code class="language-ruby"># app/views/tweets/index.html.erb
&lt;p id=&quot;notice&quot;&gt;&lt;%= notice %&gt;&lt;/p&gt;

&lt;h1&gt;Tweets&lt;/h1&gt;

&lt;h4&gt;New Tweet&lt;/h4&gt;
&lt;%= render &quot;tweets/form&quot;, tweet: @tweet %&gt;

&lt;h4&gt;Tweet Feed&lt;/h4&gt;
</code></pre>
<p>now when we check out index page again &ndash; oops, we get an error:
<img src="tweet_index_3rd_error.png" alt="tweet_index_3rd_error"></p>
<p><code>errors</code> is null because the new instance isn&rsquo;t available we need to add a new tweet to our index page from the controller:</p>
<pre><code class="language-ruby"># app/controllers/tweets_controller.rb
class TweetsController &lt; ApplicationController
  before_action :set_tweet, only: %i[ show edit update destroy ]

  def index
    # put newest tweets at the top of the page
    @tweets = Tweet.all.order(created_at: :desc)
    @tweet = Tweet.new
  end

</code></pre>
<p>Now when we view index we should be able to create a tweet on the index page:
<img src="tweet_index_4th_top.png" alt="tweet_index_4th"></p>
<p>However, after creation we still go to show page and need to navigate back to the index page - lets fix that in the create controller.  We will change the line:</p>
<p><code>format.html { redirect_to @tweet, notice: &quot;Tweet was successfully created.&quot; }</code></p>
<p>with:</p>
<p><code>format.html { redirect_to tweets_url, notice: &quot;Tweet was successfully created.&quot; }</code></p>
<p>We will have the same problem with update &ndash; so let&rsquo;s fix them both.  Now the controller should look like:</p>
<pre><code class="language-ruby"># app/controllers/tweets_controller.rb
  def create
    @tweet = Tweet.new(tweet_params)

    respond_to do |format|
      if @tweet.save
        format.html { redirect_to tweets_url, notice: &quot;Tweet was successfully created.&quot; }
        format.json { render :show, status: :created, location: @tweet }
      else
        format.html { render :new, status: :unprocessable_entity }
        format.json { render json: @tweet.errors, status: :unprocessable_entity }
      end
    end
  end

  def update
    respond_to do |format|
      if @tweet.update(tweet_params)
        format.html { redirect_to tweet_url, notice: &quot;Tweet was successfully updated.&quot; }
        format.json { render :show, status: :ok, location: @tweet }
      else
        format.html { render :edit, status: :unprocessable_entity }
        format.json { render json: @tweet.errors, status: :unprocessable_entity }
      end
    end
  end
</code></pre>
<p>now after we create a new tweet we should &lsquo;stay&rsquo; (it actually reloads - which could be slow if we had many tweets on the page - we will fix this with hotwire) on the index page and see:
<img src="tweet_index_5th_after_create.png" alt="tweet_index_5th"></p>
<p>OK we are almost there, but we still have rows of tables and not a nice tweet feed look.</p>
<p>Lets add Bootstrap CSS for some modest beauty (you can copy this file or use the below link to get the newest Bootstrap CSS)</p>
<pre><code class="language-ruby"># app/views/layout/application.html.erb
&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;title&gt;Tweets&lt;/title&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;&gt;
  &lt;%= csrf_meta_tags %&gt;
  &lt;%= csp_meta_tag %&gt;

  &lt;link rel=&quot;stylesheet&quot;
        href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css&quot;
        integrity=&quot;sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l&quot;
        crossorigin=&quot;anonymous&quot;&gt;
  &lt;%= stylesheet_link_tag 'application', media: 'all' %&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;%= yield %&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<p>you can get the newest bootstrap link from: 
<a href="https://getbootstrap.com/docs/" target="_blank" rel="noopener">https://getbootstrap.com/docs/</a> or 
<a href="https://www.bootstrapcdn.com/" target="_blank" rel="noopener">https://www.bootstrapcdn.com/</a></p>
<p>Now lets make a partial reformat our feed with bootstrap:</p>
<pre><code class="language-ruby"># app/views/tweets/_tweet.html.erb
&lt;div class=&quot;card card-body&quot;&gt;
  &lt;div&gt;&lt;%= tweet.body %&gt;&lt;/div&gt;

  &lt;div class=&quot;mt-2&quot;&gt;
    &lt;%= &quot;Like (#{tweet.likes})&quot; %&gt;

    &lt;%= &quot;Retweet (#{tweet.retweets})&quot; %&gt;

    &lt;%= link_to 'Edit', edit_tweet_path(tweet),
              class: &quot;btn btn-sm btn-success&quot; %&gt;

    &lt;%= link_to 'Destroy', tweet_path(tweet), method: :delete,
              data: { confirm: 'Are you sure?' },
              class: &quot;btn btn-sm btn-danger&quot; %&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>Now lets integrate the tweet partial into the index page:</p>
<pre><code class="language-ruby"># app/views/tweets/index.html.erb
&lt;p id=&quot;notice&quot;&gt;&lt;%= notice %&gt;&lt;/p&gt;

&lt;h1&gt;Tweets&lt;/h1&gt;

&lt;h4&gt;New Tweet&lt;/h4&gt;
&lt;%= render &quot;tweets/form&quot;, tweet: @tweet %&gt;

&lt;h4&gt;Tweet Feed&lt;/h4&gt;
&lt;%= render @tweets %&gt;
</code></pre>
<p>We now have an app that basically works from the index pages (not yet Edit, but without Hotwire, that&rsquo;s difficult &ndash; see the next article)</p>
<p><img src="tweet_index_6th_formatted.png" alt="tweet_index_6th"></p>
<p>Let&rsquo;s take another git snapshot of &lsquo;index&rsquo; reloading app.</p>
<pre><code>git add .
git commit -m &quot;tweet app mostly from the index page&quot;
</code></pre>
<h4 id="activate-likes-and-retweets">Activate likes and retweets</h4>
<p>To finish this simple app lets activate Likes and Retweets - we will do this with new controllers since this is an independent action from our tweet itself.  We will use the <code>create</code> since we are <code>creating</code> a like or a retweet.</p>
<p>Let&rsquo;s build the like controller - we will redirect back to the index where we want to stay:</p>
<pre><code class="language-ruby"># app/controllers/likes_controller.rb
class LikesController &lt; ApplicationController
  before_action :set_tweet

  def create
    @tweet.increment! :likes
    redirect_to tweets_url
  end

  private

  def set_tweet
    @tweet = Tweet.find(params[:tweet_id])
  end
end
</code></pre>
<p>And now the retweet controller:</p>
<pre><code class="language-ruby"># app/controllers/retweets_controller.rb
class RetweetsController &lt; ApplicationController
  before_action :set_tweet

  def create
    @tweet.increment! :retweets
    redirect_to tweets_url
  end

  private

  def set_tweet
    @tweet = Tweet.find(params[:tweet_id])
  end
end
</code></pre>
<p>These controllers are dependent on the tweet so they are subroutes of a tweet - so lets update our routes to be:</p>
<pre><code class="language-ruby"># config/routes.rb
Rails.application.routes.draw do
  resources :tweets do
    resource :like, only: [:create]
    resource :retweet, only: [:create]
  end
  root to: &quot;tweets#index&quot;
end
</code></pre>
<p>Now lets add the connection to controller in our front-end with buttons.  Note we need to use the <code>method: :post</code> for our like and retweet <code>create</code> because these are normally <code>posted</code> by the <code>edit</code> form.  In this case we want to bypass a form and just update.</p>
<pre><code class="language-ruby"># app/views/tweets/_tweet.html.erb
&lt;div class=&quot;card card-body&quot;&gt;
  &lt;div&gt;&lt;%= tweet.body %&gt;&lt;/div&gt;

  &lt;div class=&quot;mt-2&quot;&gt;
    &lt;%= link_to &quot;Like (#{tweet.likes})&quot;,
                tweet_like_path(tweet),
                method: :post,
                class: &quot;btn btn-sm btn-outline-success&quot; %&gt;

    &lt;%= link_to &quot;Retweet (#{tweet.retweets})&quot;,
                tweet_retweet_path(tweet),
                method: :post,
                class: &quot;btn btn-sm btn-outline-info&quot; %&gt;

    &lt;%= link_to 'Edit', edit_tweet_path(tweet),
                class: &quot;btn btn-sm btn-outline-primary&quot; %&gt;

    &lt;%= link_to 'Destroy', tweet_path(tweet), method: :delete,
                data: { confirm: 'Are you sure?' },
                class: &quot;btn btn-sm btn-outline-danger&quot; %&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>Test that everything works as expected!  Assuming it works - we will take another snapshot.</p>
<pre><code class="language-bash">git add .
git commit -m &quot;likes and retweets enabled and also 'stay' on index page&quot;
</code></pre>
<p><img src="tweet_index_7th_likes_retweets.png" alt="tweet_index_7th"></p>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/rails/">Rails</a>
  
  <a class="badge badge-light" href="/tags/rails-6/">Rails 6</a>
  
  <a class="badge badge-light" href="/tags/hotwire/">Hotwire</a>
  
  <a class="badge badge-light" href="/tags/spa/">SPA</a>
  
  <a class="badge badge-light" href="/tags/html/">HTML</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/&amp;text=Tweets%20-%20A%20Single%20Page%20Rails%20App%20%28using%20reloads%29" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/&amp;t=Tweets%20-%20A%20Single%20Page%20Rails%20App%20%28using%20reloads%29" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Tweets%20-%20A%20Single%20Page%20Rails%20App%20%28using%20reloads%29&amp;body=http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/&amp;title=Tweets%20-%20A%20Single%20Page%20Rails%20App%20%28using%20reloads%29" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Tweets%20-%20A%20Single%20Page%20Rails%20App%20%28using%20reloads%29%20http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=http://localhost:1313/post_ruby_rails/rails_6_1_single_page_app_simulate/&amp;title=Tweets%20-%20A%20Single%20Page%20Rails%20App%20%28using%20reloads%29" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/authors/btihen/avatar_hu1862451442ed779787ed1b218e0a75c3_96954_270x270_fill_q90_lanczos_center.jpeg" alt="Bill Tihen">
      

      <div class="media-body">
        <h5 class="card-title"><a href="http://localhost:1313/">Bill Tihen</a></h5>
        <h6 class="card-subtitle">Developer, Data Enthusiast, Educator and Nature&rsquo;s Friend</h6>
        <p class="card-text">very curious &ndash; known to explore knownledge and nature</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/btihen" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/btihen" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/bill-tihen" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/files/TihenWilliamResume-2020.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  


  














  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.8/mermaid.min.js" integrity="sha256-lyWCDMnMeZiXRi7Zl54sZGKYmgQs4izcT7+tKc+KUBk=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/crystal.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/elixir.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/ruby.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/swift.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.4aaf2d64e50f8e54cf66dcc54147a22e.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    © 2021
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
